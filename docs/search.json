[
  {
    "objectID": "Homework4.html#homework4-for-st558",
    "href": "Homework4.html#homework4-for-st558",
    "title": "Homework4",
    "section": "Homework4 for ST558",
    "text": "Homework4 for ST558"
  },
  {
    "objectID": "Homework4.html#task-1-conceptual-questions",
    "href": "Homework4.html#task-1-conceptual-questions",
    "title": "Homework4",
    "section": "Task 1: Conceptual Questions",
    "text": "Task 1: Conceptual Questions\n\n1. What is the purpose of the lapply() function? What is the equivalent purrr function?\nThe lapply() function in R is used to apply a function to each element of a list or vector and return a list of the same length. The equivalent function in the purrr package is map().\n\n\n2. Suppose we have a list called my_list. Each element of the list is a numeric data frame (all columns are numeric). We want use lapply() to run the code cor(numeric_matrix, method = “kendall”) on each element of the list. Write code to do this below! (I’m really trying to ask you how you specify method = “kendall” when calling lapply()).\nlapply(my_list, function(df) cor(df, method = “kendall”))\n\n\n3. What are two advantages of using purrr functions instead of the BaseR apply family?\nThe purrr functions provide more consistent and predictable output types, and offer enhanced functionality and ease of use with more expressive syntax and additional features.\n\n\n4. What is a side-effect function?\nSide-effect functions are functions that perform additional operations beyond returning a value, such as modifying global variables, printing to the console, or writing to files. While they are necessary for many practical tasks, they should be used carefully to maintain code clarity and predictability.\n\n\n5. Why can you name a variable sd in a function and not cause any issues with the sd function?\nDue to R’s scoping rules, which determine how R resolves variable names and function names in different contexts, particularly through lexical scoping and the use of environments."
  },
  {
    "objectID": "Homework4.html#task-2---writing-r-functions",
    "href": "Homework4.html#task-2---writing-r-functions",
    "title": "Homework4",
    "section": "Task 2 - Writing R Functions",
    "text": "Task 2 - Writing R Functions\nFirstly, I write a function to get RMSE, and remove NA values.\n\ngetRMSE &lt;- function(response, predicted, ...) {\n  # Ensure that response and predicted are the same length\n  if (length(response) != length(predicted)) {\n    stop(\"The lengths of response and predicted values must be the same\")\n  }\n  \n  # Calculate the mean of the squared differences\n  mean_squared_diff &lt;- mean((response - predicted)^2, ...)\n  \n  # Calculate the square root of the mean squared differences\n  root_mean_squared_error &lt;- sqrt(mean_squared_diff)\n  \n  return(root_mean_squared_error)\n}\n\nThen, I will create some response and prediction values\n\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x + rnorm(n)\npred &lt;- predict(lm(resp ~ x), data.frame(x))\n\nThen, I will use generated values to test my RMSE function.\n\ngetRMSE(resp, pred)\n\n[1] 0.9581677\n\n\nThen, I will replace two of the response values with NA, and then test RMSE function.\n\nresp_na &lt;- replace(resp, c(1,80), c(NA,NA))\n\ngetRMSE(resp_na, pred)\n\n[1] NA\n\ngetRMSE(resp_na, pred, na.rm = TRUE)\n\n[1] 0.959715\n\n\nThe another common metric for evaluating predictions is MAE. I will write a function to get MAE.\n\ngetMAE &lt;- function(response, predicted, ...) {\n  # Ensure that response and predicted are the same length\n  if (length(response) != length(predicted)) {\n    stop(\"The lengths of response and predicted values must be the same\")\n  }\n  \n  # Calculate the mean of the squared differences\n  mean_absolute_deviation &lt;- mean(abs(response - predicted), ...)\n  \n  return(mean_absolute_deviation)\n}\n\nThen, I will create some response and prediction values\n\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x + rnorm(n)\npred &lt;- predict(lm(resp ~ x), data.frame(x))\n\nThen, I will use generated values to test my MAE function.\n\ngetMAE(resp, pred)\n\n[1] 0.8155776\n\n\nThen, I will replace two of the response values with NA, and then test RMSE function.\n\nresp_na &lt;- replace(resp, c(1,80), c(NA,NA))\n\ngetMAE(resp_na, pred)\n\n[1] NA\n\ngetMAE(resp_na, pred, na.rm = TRUE)\n\n[1] 0.8156589\n\n\n\nmy_wrapper &lt;- function(response, predicted, rmse = TRUE, mae = TRUE) {\n  # Ensure that response and predicted are the same length\n  if (length(response) != length(predicted)) {\n    stop(\"The lengths of response and predicted values must be the same\")\n  }\n  \n  if (is.vector(response) & is.atomic(response) & is.numeric(response) == FALSE) {\n    stop(\"The response value must be the an atomic numertic vector\")\n  }\n  \n  if (is.vector(predicted) & is.atomic(predicted) & is.numeric(predicted) == FALSE) {\n    stop(\"The predicted value must be the an atomic numertic vector\")\n  }\n\n  RMSE &lt;- getRMSE(response, predicted, na.rm = TRUE)\n  MAE &lt;- getMAE(response, predicted, na.rm = TRUE)\n\n  if (rmse == TRUE & mae == FALSE) {\n    return(RMSE)\n  } else if (rmse == FALSE & mae == TRUE) {\n    return(MAE)\n  } else if (rmse == TRUE & mae == TRUE) {\n    return(list(RMSE = RMSE, MAE = MAE))\n  }\n  \n} \n\nThen, I will create some response and prediction values\n\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x + rnorm(n)\npred &lt;- predict(lm(resp ~ x), data.frame(x))\n\nThen, I will test the wapper function\n\nmy_wrapper(resp, pred)\n\n$RMSE\n[1] 0.9581677\n\n$MAE\n[1] 0.8155776\n\nmy_wrapper(resp, pred, rmse = TRUE, mae = FALSE)\n\n[1] 0.9581677\n\nmy_wrapper(resp, pred, rmse = FALSE, mae = TRUE)\n\n[1] 0.8155776\n\n\nThen, I will replace two of the response values with “A”, and then test the function.\n\nresp_A &lt;- replace(resp, c(1,80), c(\"A\",\"A\"))\n\nmy_wrapper(resp_A, pred)\n\nError in my_wrapper(resp_A, pred): The response value must be the an atomic numertic vector"
  },
  {
    "objectID": "Homework4.html#task-3---querying-an-api-and-a-tidy-style-function",
    "href": "Homework4.html#task-3---querying-an-api-and-a-tidy-style-function",
    "title": "Homework4",
    "section": "Task 3 - Querying an API and a Tidy-Style Function",
    "text": "Task 3 - Querying an API and a Tidy-Style Function\nReturn information about Tesla that has been in the news lately.\n\nURL_id &lt;- \"https://newsapi.org/v2/everything?q=tesla&from=2024-05-26&sortBy=publishedAt&apiKey=d9af7dcfe6714e77bd2c1722b33575c7\"\nnews_info &lt;- httr::GET(URL_id)\nstr(news_info, max.level = 1)\n\nList of 10\n $ url        : chr \"https://newsapi.org/v2/everything?q=tesla&from=2024-05-26&sortBy=publishedAt&apiKey=d9af7dcfe6714e77bd2c1722b33575c7\"\n $ status_code: int 200\n $ headers    :List of 14\n  ..- attr(*, \"class\")= chr [1:2] \"insensitive\" \"list\"\n $ all_headers:List of 1\n $ cookies    :'data.frame':    0 obs. of  7 variables:\n $ content    : raw [1:88182] 7b 22 73 74 ...\n $ date       : POSIXct[1:1], format: \"2024-06-26 03:51:03\"\n $ times      : Named num [1:6] 0 0.00926 0.02237 0.08453 0.4611 ...\n  ..- attr(*, \"names\")= chr [1:6] \"redirect\" \"namelookup\" \"connect\" \"pretransfer\" ...\n $ request    :List of 7\n  ..- attr(*, \"class\")= chr \"request\"\n $ handle     :Class 'curl_handle' &lt;externalptr&gt; \n - attr(*, \"class\")= chr \"response\"\n\n\nParse the returned data into tibble table, and find the article content.\n\nlibrary(jsonlite)\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter()  masks stats::filter()\n✖ purrr::flatten() masks jsonlite::flatten()\n✖ dplyr::lag()     masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nparsed &lt;- fromJSON(rawToChar(news_info$content)) \nnews&lt;- as_tibble(parsed$articles)\nhead(news)\n\n# A tibble: 6 × 8\n  source$id  $name author title description url   urlToImage publishedAt content\n  &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n1 financial… Fina… Bloom… LG C… LG Chem Lt… http… \"https://… 2024-06-25… \"(Bloo…\n2 &lt;NA&gt;       Asri… info@… کادی… جنرال موتو… http… \"\"         2024-06-25… \". 2 2…\n3 &lt;NA&gt;       Www.… Zeno … INTE… Die Greate… http… \"https://… 2024-06-25… \"Die S…\n4 &lt;NA&gt;       Www.… Zeno … INTE… Die Greate… http… \"https://… 2024-06-25… \"Die S…\n5 &lt;NA&gt;       Ixbt… jin@i… Боль… После того… http… \"https://… 2024-06-25… \", Tes…\n6 financial… Fina… Bloom… BYD … China’s BY… http… \"https://… 2024-06-25… \"(Bloo…\n\nnews$content[3]\n\n[1] \"Die Stadt Zürich ist das Lieblingsziel vieler Unternehmen, die in die Schweiz ziehen.\\r\\nHerr Huber, als neuer Chef der Greater Zurich Area übernehmen Sie die Führung der Standortmarketingorganisation … [+7960 chars]\"\n\n\nWrite a function to query API.\n\nquery &lt;-function(subject, date, apiKey) {\n  base_url &lt;- \"https://newsapi.org/v2/everything?\"\n  URL_id &lt;- paste0(base_url, \"q=\", subject, \"&from=\", date, \"&sortBy=publishedAt&apiKey=\", apiKey)\n\n  info &lt;- httr::GET(URL_id)\n  parsed &lt;- fromJSON(rawToChar(info$content)) \n  news&lt;- as_tibble(parsed$articles)\n  return(news)\n}\n\nThen, test function.\n\nsports &lt;- query(\"sport\", \"2024-05-28\", \"d9af7dcfe6714e77bd2c1722b33575c7\")\nhead(sports)\n\n# A tibble: 6 × 8\n  source$id $name  author title description url   urlToImage publishedAt content\n  &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n1 &lt;NA&gt;      Trend… Amy D… Spor… \"(TrendHun… http… https://c… 2024-06-25… \"Palac…\n2 &lt;NA&gt;      Inter… Andrz… Sześ… \"Wojciech … http… https://i… 2024-06-25… \"Szczs…\n3 espn      ESPN   Greg … The … \"After 30 … http… https://a… 2024-06-25… \"SUNRI…\n4 &lt;NA&gt;      CNET   Gael … Toda… \"Here's to… http… https://w… 2024-06-25… \"Look …\n5 &lt;NA&gt;      Onet.… &lt;NA&gt;   Braz… \"&lt;![CDATA[… http… https://o… 2024-06-25… \"Wielk…\n6 &lt;NA&gt;      Www.n… Meret… Die … \"Nach deme… http… https://i… 2024-06-25… \"Vertr…\n\n\nTest function again.\n\nmusic &lt;- query(\"music\", \"2024-06-02\", \"d9af7dcfe6714e77bd2c1722b33575c7\")\nhead(sports)\n\n# A tibble: 6 × 8\n  source$id $name  author title description url   urlToImage publishedAt content\n  &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n1 &lt;NA&gt;      Trend… Amy D… Spor… \"(TrendHun… http… https://c… 2024-06-25… \"Palac…\n2 &lt;NA&gt;      Inter… Andrz… Sześ… \"Wojciech … http… https://i… 2024-06-25… \"Szczs…\n3 espn      ESPN   Greg … The … \"After 30 … http… https://a… 2024-06-25… \"SUNRI…\n4 &lt;NA&gt;      CNET   Gael … Toda… \"Here's to… http… https://w… 2024-06-25… \"Look …\n5 &lt;NA&gt;      Onet.… &lt;NA&gt;   Braz… \"&lt;![CDATA[… http… https://o… 2024-06-25… \"Wielk…\n6 &lt;NA&gt;      Www.n… Meret… Die … \"Nach deme… http… https://i… 2024-06-25… \"Vertr…"
  }
]